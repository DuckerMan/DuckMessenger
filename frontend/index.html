<!DOCTYPE html> 


<html> 
<head> 






  <script src="//ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
   <script src="js/socketiop2p.min.js"></script>
  <script src="js/circle-progress.min.js"></script>
  <script language="javascript" src="js/lz-string.js"></script>
   <script language="javascript" src="js/async.js"></script>
<!--  <script src="/js/recorder.js"></script> -->
<script type="text/javascript" src="https://cdn.rawgit.com/ricmoo/aes-js/e27b99df/index.js"></script>
 <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">

  <!-- Compiled and minified JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>

  <script src="js/comServer.js"></script>
  <script src="js/client.js"></script>
<!--   <script src="assets/js/main.js"></script> -->

  <script src="/socket.io/socket.io.js"></script>
  

  
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

        <meta name="viewport" content="initial-scale=1, maximum-scale=1">
<title>Duck Messenger</title> 
 <meta name="description" content="DuckMessenger is a free and opensource Messenger">


<style>


::-webkit-scrollbar {
  width: 5px;
  height: 5px;
}
::-webkit-scrollbar-button {
  width: 0px;
  height: 0px;
}
::-webkit-scrollbar-thumb {
  background: #f6f5f5;
  border: 0px none #ffffff;
  border-radius: 50px;
}
::-webkit-scrollbar-thumb:hover {
  background: #ffffff;
}
::-webkit-scrollbar-thumb:active {
  background: #ffffff;
}
::-webkit-scrollbar-track {
  background: #c3bebe;
  border: 0px none #ffffff;
  border-radius: 50px;
}
::-webkit-scrollbar-track:hover {
  background: #666666;
}
::-webkit-scrollbar-track:active {
  background: #847d7d;
}
::-webkit-scrollbar-corner {
  background: transparent;
}

html{  width: 100%;
  overflow: hidden; /* дабы не было скролла при пульсации */
  height: 100%;background: #5682a3;font-family: Roboto;}


@import url('https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300|Open+Sans:100,200,300,400,500,600,700|Poiret+One|Roboto:100,200,300, 300i,400, 400i,500, 500i,700&subset=cyrillic');

 @font-face {
    font-family: ProximaNovaCondesedSemibold; /* Имя шрифта */
    src: url("fonts/Proxima Nova Condensed Semibold.otf"); /* Путь к файлу со шрифтом */
   }
    @font-face {
    font-family: ProximaNovaRegular; /* Имя шрифта */
    src: url("fonts/Proxima Nova Regular.otf"); /* Путь к файлу со шрифтом */
   }
    @font-face {
    font-family: ProximaNovaSemibold; /* Имя шрифта */
    src: url("fonts/Proxima Nova Semibold.otf"); /* Путь к файлу со шрифтом */
   }

@keyframes loadingFirst{
  from{
    top: 37%;
  }
  45%{
    height: 100px;
  }
  50%{
    top: 50%;
  }
  100%{
    height: 128px;
  }
  to{
     top: 37%;
  }
}

@keyframes shake{
  from{
    left: 40.7%;
        
  }
  50%{
    left: 41.3%;
    
  }
  to{
    left: 40.7%;

  }
}
#firstLoadingAnimation{
  width: 128px;
  height:128px;
  border-radius: 50%;
  background-color:#3857b2;
  animation: loadingFirst 1.5s infinite;
  position: absolute;
  margin:-64px 0 0 -64px;
  display: none;
  left:50%;
top:50%;

}
.popUpDialog{
   z-index: 15;
  width: 480px;
height: 290px;
position: absolute;
background:white;
border-radius: 2px;
    z-index: 17;

position:absolute;
left:50%;
top:50%;
margin:-145px 0 0 -240px;
overflow: hidden;
display: none;
}

.simpleBlock{
    width: 480px;
height: 290px;
position: absolute;
background:white;
border-radius: 2px;
    z-index: 10;

position:absolute;
left:50%;
top:50%;
margin:-145px 0 0 -240px;
overflow: hidden;
display: none;
}

.simpleBlock #title{
  font-family: Roboto;
    font-size: 17px;
    color: #212121;
    position: relative;
    /* float: left; */
    /* top: 19px; */
    /* left: 45px; */
    text-align: center;
    font-weight: 400;
    top: -5px;


}
.subText{
  font-family: Roboto;
  color: #7d7d7d;
  font-size: 12px;
  font-weight: 300;
  display: none;
}
#blockAuth{
  height: 220px;
  margin:-110px 0 0 -240px;
}
#blockAuth #nextStepButtonAuth{

}
.nextStepButton{
   background: #3F51B5;
    position: relative;
    top: 16px;
}
.nextStepButton:hover{
      background-color: #5164ce;
}
#blockAuth #subText{
position: relative;
    top: 13px;

}
#blockAuth .progressAuth{
  position: relative;
    top: 9px;
    width: 325px;
    display: none;
}

.popUpDialogInfo{
   z-index: 17;
   width: 400px;
    height: 140px;
    position: absolute;
    background: white;
    border-radius: 1px;
    z-index: 11;
    position: absolute;
    left: 50%;
    top: 50%;
    margin: -70px 0 0 -200px;
    overflow: hidden;
    display: none;
}

.popUpDialogInfo #title{
font-family: Roboto;
    font-size: 17px;
    color: #212121;
    position: absolute;
    float: left;
    top: 6px;
    left: 39px;
    font-weight: bold;


}
.popUpDialogInfo #text{
  font-family: Roboto;
    font-size: 17px;
    color: #484747;
    position: relative;
    text-align: center;
    top: 21px;
    font-weight: 400;
  


}
.popUpDialogInfo #cancelButton{
position: absolute;
bottom: 2px;
padding: 9px 7px;
right: 50px;
    line-height: 19px;
}
.popUpDialogInfo #agreeButton{
  position: absolute;
bottom: 2px;
right: 9px;
padding: 9px 7px;
    line-height: 19px;
}
#mask{
  z-index: 14;
  width: 115%;
  height: 115%;
  left: -10%;
  top: -10%;
  position: fixed;
  cursor: pointer;

  background: rgba(0, 0, 0, 0.3);
  display: none;
}


div #leftPanelMessages{
  width: 265px;
  height: 100%;
  position: fixed;
  z-index: 11;
  background: white;
  overflow: auto;
}
div #leftPanelMessages .dialog{
  width: 100%;
  
  height: 56px;
  background-color: white;
      top: 48px;
    margin-top: 0px;


}
div #leftPanelMessages .dialog:first-child {
    /* top: 28px; */
    margin-top: -3px;
}


div#topPanelWithMenu {
  position: absolute;
    background: white;
    width: 100%;
    height: 45px;
    top: 0px;

}


.selectedDialog{
background-color: #1976D2 !important;
}

.selectedName{
color: #ffffff !important;
}

.selectedText{
color: #e8e8e8 !important;
}

div #leftPanelMessages .dialog #templateName{
    position: absolute;
    width: 159px;
    height: 15px;
    border-radius: 10px;
    top: -5px;
    left: 64px;
    background: #E3F2FD;
}





div #leftPanelMessages .dialog #templateImage{
  position: absolute;
    width: 48px;
    height: 48px;
    border-radius: 100px;
    top: 3px;
    left: 5px;
    background: #caced2;
}
div #leftPanelMessages .dialog #templateMessage{
    position: absolute;
    width: 159px;
    height: 13px;
    border-radius: 10px;
    top: 19px;
    left: 64px;
    background: #d4d7da;

}

div #leftPanelMessages .dialog #userName{
       position: relative;
    font-size: 15px;
    top: -11px;
    left: 62px;
    color: #212121;
    font-weight: 500;
        width: 182px;
}

div #leftPanelMessages .dialog #profilePhoto{
position: relative;
    width: 48px;
    height: 48px;
    top: -81px;
    left: 6px;
    border-radius: 100px;
}
.messagesBlock {
    overflow: auto;
    height: 93%;
}
.statusSendMessage{
      font-size: 16px;
    position: relative;
    bottom: -9px;
    right: -4px;
    float: right;
    color: #1bff1b;
}


.mobileBackButton {
    color: #757575;
    position: relative;
    float: left;
     font-size: 32px;
     display: none;

}
.backDialogs{
  margin-top: 7px;
    margin-left: 12px;
    cursor: pointer;
    width: 32px;
    height: 32px;
}
    

.rightBlock{
  background: #ececec;
  position: absolute;
  height: 100%;
  left: 265px;
  z-index: 1;
}

div #leftPanelMessages .dialog #textMessage{
      position: relative;
    font-size: 14px;
    top: -26px;
    left: 63px;
    color: #797979;
        width: 182px;
        height: 19px;
}


div .userInfoTopPanel {
 width: 100%;
    height: 45px;
    background: white;
    z-index: 15;
        transform-style: preserve-3d;
    position: sticky;
        /*transform: rotateX(180deg);*/
    top: 0px;
    transition:500ms;
}
div .userInfoTopPanel .back{
    width: 100%;

    display: none;
    transform: rotateX(180deg);
    transform-style: preserve-3d;
}

.whatDoWithMsgButton:hover {
    background: #5d68f3;
}
.whatDoWithMsgButton {
      background: #6d77f3;
    padding: 1px 22px;
    height: 35px;
    position: relative;
    float: right;
    top: -41px;
    margin-left: 7px;
    right: 10px;
    font-weight: 500;
}
.cirleLoadImage {
    position: absolute;
    left: 45px;
    z-index: 1;
    top: 28px;
    display: none;
}
#topPanelName{

      font-size: 17px;
    position: relative;
    float: left;
    display: inline;
    margin-top: 2px;
    margin-left: 12px;
    color: #272727;
    font-weight: 500
}

.topPanelLastonline{
  display: inline-block;
    position: absolute;
    float: left;
    left: 54px;
    top: 10px;
    font-size: 13px;
}
#profilePhotoTopPanel{
    width: 36px;
    height: 36px;
    position: relative;
    border-radius: 50%;
    float: left;
        margin-left: 6px;
            top: 4px;
            cursor: pointer;
}
p.topPanelLastonline.online{
    color: #388E3C;
}
p.topPanelLastonline.offline{
  color: #969696;
}

#noDialogsText{
  color: #565656;
    font-size: 18px;
    position: absolute;
    left: 10%;
    display: none;
    top: 39%;
}

.messageSendBlock{
position: absolute;
    bottom: 0px;
    width: 90%;
  
    height: 47px;
    border-radius: 4px;
    color: #212121;
    padding-left: 35px;
    padding-top: 10px;
    padding-right: 40px;
    overflow: auto;
    background: white;
    border-bottom: 1px solid #dedede;
}

.sendMsgButton{
      position: absolute;
    right: 3px;
    font-size: 35px;
    color: #757575;
    cursor: pointer;
    transition: 300ms;
    top: 6px;

}

.sendMsgButton:hover{
color: #5a5a5a;
}

.messagesSendSection{
position: absolute;
    bottom: 0px;
    width: 100%;
  background: white;
    height: 47px;
}

.sendAttachmentButton{
      transform: rotate(90deg);
    position: absolute;
    font-size: 32px;
    height: 36px;
    width: 36px;
    color: #757575;
    cursor: pointer;
    left: -3px;
    top: 8px;
    z-index: 23;

}


.dialogsImageSend{
          max-width: 305px;
    max-height: 450px;
    cursor: pointer;
}


@keyframes typing{
  0%{
    opacity: 0.5;
  }
   25%{
    opacity: 1;
  }
   50%{
    opacity: 0.5;
  }
}

@keyframes typingTwo{
  25%{
    opacity: 0.5;
  }
   50%{
    opacity: 1;
  }
   75%{
    opacity: 0.5;
  }
}
.animationSpan{
  width: 8px;
  height: 8px;
  background: #d8d8d8;
  float: left;
  position: relative;
  margin-left: 3px;
  border-radius: 50%;
animation: typing 1s infinite linear;

}
.animationSpan:nth-child(2){
animation: typingTwo 1s infinite linear;
}




.animationDiv{
  position: absolute;
    top: 29px;
    left: 54px;
    display: none;
}
/* Dialogs */





.messagesList{
  list-style: none;
  margin: 0;
  padding: 0;
      position: relative;
    top: 54px;
}

.messagesList li{
display: inline-block;
    clear: both;
    padding-top: 5px;
    padding-bottom: 5px;
    padding-left: 7px;
    padding-right: 7px;
    max-width: 320px;
  
    border-radius: 6px;
    margin-bottom: 6px;
    font-family: Roboto;
}

.messageToMe{
  background: #eee;
  float: left;
  background: #7cb8ef;
    color: white;
    border-bottom-left-radius: 5px;
    max-width: 320px;
    word-wrap: break-word;

}

.messageFromMe{
  cursor: pointer;
  float: right;
  background: #0084ff;
  color: #fff;
  max-width: 320px;
    word-wrap: break-word;
      border-bottom-right-radius: 5px;

      margin-right: 6px;
}

.messageToMe + .messageFromMe{
  border-bottom-right-radius: 5px;
}

.messageFromMe + .messageFromMe{
  border-bottom-right-radius: 5px;
}


.fileUploadingInfo{
    width: 320px;
    height: 140px;
    margin: -70px 0 0 -160px;
    z-index: 15;
}

.fileUploadingInfo .filePreview{
      position: absolute;
    width: 110px;
    height: 110px;
    top: 15px;
    left: 15px;
}
.fileUploadingInfo .fileName{
    display: inline-block;
    position: absolute;
    left: 141px;
    font-size: 16px;
    color: #212121;
    font-weight: 400;
    top: 0px;
}
.fileUploadingInfo .bytesLoading{
    display: inline-block;
    position: absolute;
    left: 141px;
    font-size: 13px;
    color: #565656;
    font-weight: 400;
    top: 27px;
}

.fileUploadingInfo .loadProgress {
    position: absolute;
    width: 96%;
    left: 7px;
    border-radius: 1px;
    bottom: -9px;
}


.audioMessage{
      width: 280px;
    height: 42px;
}
.audioMessage .playOrStopButton{
      position: relative;
    width: 40px;
    margin-left: 3px;
    top: 1px;
    height: 40px;
    background: white;
    border-radius: 50%;
    float: left;
        cursor: pointer;
}

.audioMessage .audioTime{
position: relative;
    width: 81%;
    height: 3px;
    margin-left: 47px;
    top: -19px;
    background: #c3c3c3;
}
.audioMessage .audioFullTime{
    width: 50%;
    height: 3px;
    background: #e4e4e4;
    transition: 300ms;
}
.audioMessage .audioName{
position: relative;
    font-size: 15px;
    color: white;
    left: 3px;
    margin-top: 0px;
    top: -3px;
}
/* end */

.mySettings{
  display: none;

   z-index: 15;
}
.mySettings #headerBlock{
    position: absolute;
    width: 100%;
    height: 99px;
    background: #a2a2f1;
}
.mySettings #myProfilePhoto{
border-radius: 50%;
    position: relative;
    width: 64px;
    height: 64px;
    transition: 300ms;
    margin-left: 33px;
    margin-top: 16px;
    display: inline-block;
    float: left;

}
.mySettings #nameAndSurname{
  position: relative;
    float: left;
    display: inline-block;
    font-size: 15px;
    color: white;
    font-family: Roboto;
    margin-left: 7px;
    margin-top: 18px;
    font-weight: 500;
}

.mySettings #loginUser{
position: absolute;
    left: 104px;
    top: 26px;
    /* float: left; */
    /* clear: left; */
    display: inline-block;
    font-size: 15px;
    color: #f1eded;
    font-family: Roboto;
}

.mySettings #buttonChangeProfilePhoto{
  position: absolute;
    right: 17px;
    top: 70px;
    background: #66538a;
}


.photoWatcher{
  width: 100%;
  height: 100%;
  position: fixed;
  left: 0px;
  top: 0px;
display: none;
  background: rgba(0,0,0, 0.64);
  z-index: 16;
  cursor: pointer;
  transition: 300ms;
}

.photoWatcher:hover{

  background: rgba(0,0,0, 0.57);
}


.photoWatcher .imageView{
   cursor: pointer;
position: absolute;
    top: 0;
    right: 0;
    bottom: 0;
    left: 0;
    margin: auto;
    max-width: 75%;
    max-height: 75%;
}
.closeIcon{
    position: absolute;
    right: 11px;
    top: 12px;
    color: #e8e5e5;
    font-size: 36px;
    transition: 300ms;
    cursor: pointer;
    transform: rotate(-41deg);
}
.closeIcon:hover{
  color: white;


}

.searchBlockTopPanel{
  position: absolute;
    left: 46px;
    width: 81%;
    height: 24px;
    top: 10px;
}
.searchInputTopPanel::-webkit-input-placeholder {
    color: #888888;
}

.searchInputTopPanel::-moz-placeholder          {color:#888888;}/* Firefox 19+ */
.searchInputTopPanel:-moz-placeholder           {color:#888888;}/* Firefox 18- */
.searchInputTopPanel:-ms-input-placeholder      {color:#888888;}


.searchInputTopPanel::-webkit-input-placeholder       {text-indent: 0px;   transition: text-indent 335ms ease;}
.searchInputTopPanel::-moz-placeholder                {text-indent: 0px;   transition: text-indent 335ms ease;}
.searchInputTopPanel:-moz-placeholder                 {text-indent: 0px;   transition: text-indent 335ms ease;}
.searchInputTopPanel:-ms-input-placeholder            {text-indent: 0px;   transition: text-indent 335ms ease;}
.searchInputTopPanel:focus::-webkit-input-placeholder {text-indent: 500px; transition: text-indent 335ms ease;}
.searchInputTopPanel:focus::-moz-placeholder          {text-indent: 500px; transition: text-indent 335ms ease;}
.searchInputTopPanel:focus:-moz-placeholder           {text-indent: 500px; transition: text-indent 335ms ease;}
.searchInputTopPanel:focus:-ms-input-placeholder      {text-indent: 500px; transition: text-indent 335ms ease;}


.searchInputTopPanel {
    position: absolute;
    overflow: hidden;
    outline: none;
    border: 0;
    border-radius: 4px;
    padding: 7px 16px;
    background: #f7f7f7;
    top: -4px;
    color: #212121;
    width: 100%;
}

.myСontacts{
z-index: 16;
    margin: -245px 0 0 -160px;
    width: 320px;
        height: 490px;


}
.myСontacts #headerTitle{

    position: absolute;
    top: 0px;
    width: 100%;
    height: 40px;
    background: #f1f1f1;
        border-bottom: 1px solid #dedede;
}
.myСontacts #titleHeaderText{
  font-family: Roboto;
    font-size: 18px;
    color: #4c4c4c;
    font-weight: 500;
    position: absolute;
    left: 10px;
    top: -11px;


}
.myСontacts .contentContacts{
width: 100%;
    height: calc(100% - 40px);
    position: absolute;
    top: 40px;
    background: white;
}
.myСontacts .userImage{
    width: 49px;
    height: 49px;
    border-radius: 53px;
        margin-left: 8px;
        margin-top: 8px;
}
.userBlock:first-child {
    margin-top: 7px;
}
.myСontacts .userBlock{
    display: inline-block;
    width: 100%;
    height: 64px;
}
.myСontacts .userName{
    font-size: 15px;
    color: #212121;
    display: inline-block;
    position: absolute;
    margin-top: 9px;
    margin-left: 8px;
}
.myСontacts .whenWasAdded {
    font-size: 13px;
    color: #777777;
    display: inline-block;
    position: absolute;
    margin-top: 28px;
    margin-left: 8px;
}
#backContacts{
      top: 6px;
    left: -20px;
}
#closeContacts{
display: block;
position: absolute;
right: 5px;
top: 1px;
color: #757575;
transform: rotate(0deg);
}
#closeContacts:hover{
color: #615f5f;
}
.userVerify {
    width: 15px;
    top: 2px;
    left: 5px;
    height: 15px;

}


.addContact{
z-index: 17;
    width: 235px;
    height: 170px;
    margin: -145px 0 0 -117.5px;

}

.cirleLoadImageMsg{
  position: relative;
    margin-top: -51px;

    height: 47px;
    top: -146px;
    display: none;
    left: 42%;
}

.cirleLoadUserImageCall{
    position: absolute;
    top: 95px;
    left: 40%;
    display: none;
    z-index: 3;
}

.dragAndDrop{
width: 400px;
    background: white;
    height: 300px;
    position: fixed;
    display: none;
    margin: -150px 0 0 -200px;
}
.unactiveDragAndDrop{
background: #ececec;
}
.unactiveDragAndDrop #dragText{
color: #6b6b6b !important;
}
.dragAndDrop #dragText{
  font-size: 16px;
  font-family: Roboto;
  position: relative;
  color: #212121;
}

.callToUser {
    position: absolute;
    right: 14px;
    color: #656565;
    top: 7px;
    cursor: pointer;
    font-size: 32px;

}

.callingProcessBlock{
    display: block;
    width: 270px;
    margin: -200px 0 0 -135px;

    background: #4a4949;
    border-radius: 15px;
    height: 400px;
    transition: 400ms;
}
.callingProcessBlock #userImageCalling{
 width: 270px;
    height: 270px;
    position: absolute;
    float: left;
}
.callingProcessBlock .userInfoCall{
display: inline-block;
    font-size: 17px;
    color: white;
    position: absolute;
    z-index: 2;
    right: 0;
    left: 0;
    margin: auto;
    bottom: 96px;

}
.callingProcessBlock #callingEnd{
position: absolute;
    bottom: 14px;
    left: 41%;
}

.callingProcessBlock #callingDisline{
position: absolute;
    bottom: 14px;
    left: 59%;
  }
  .callingProcessBlock #callingAccept{
position: absolute;
    bottom: 14px;
    left: 20%;
  }
.animationCalling{
       position: absolute;
    bottom: 81px;
    left: 44%;
    display: none;

}

  .callReturnButton{

 position: absolute;
    z-index: 20;
    right: 10px;
    bottom: 10px;

  }

  .messageLinkText{
        color: white;
    font-weight: 500;
    cursor: pointer;
  }



  .simpleInformation{
        z-index: 3;
    color: #f9f8f8;
    position: absolute;
    background: rgba(107, 107, 107, 0.59);
    border-radius: 121px;
    padding: 2px 11px;
    font-size: 13px;
    display: none;
  }
  .callingTime{
    left: 11px;
    top: 3px;
    display: block;
  }
@media screen and (max-width: 480px){
  .callingProcessBlock{
      width: 100%;
    position: absolute;
    top: 0px;
    left: 0px;
    margin: 0px;
    height: 100%;
    border-radius: 0px;
  }

  .cirleLoadUserImageCall{
    -webkit-filter: brightness(0.3);
    -moz-filter: brightness(0.3);

  }
  .callingProcessBlock #callingEnd{
bottom: 32px;
  }

   .callingProcessBlock #callingDisline{
bottom: 32px;
  }
  .callingProcessBlock #callingAccept{
bottom: 32px;
  }
  .animationCalling{
    bottom: 114px;
  }
  .callingProcessBlock .userInfoCall{
        margin: auto;
    top: -85%;
    bottom: 0px;
    height: 29px;
    display: inline-block;
    font-size: 18px;

  }
  .callingProcessBlock #userImageCalling{
        width: 100%;
    height: 100%;
    position: relative;

    -webkit-filter: brightness(0.3);

    -moz-filter: brightness(0.3);
  }
  .myСontacts #titleHeaderText{
    left: 38px;
  }
  .dragAndDrop{
    /* если это сработает на проде, дайте знать мне, t.me/DuckerMan */
    background: red;
  }
  #closeContacts{
    display: none;
  }
  div #leftPanelMessages{
    width: 100%;
  }
  .myСontacts{
margin: -76% 0 0 -160px;
    height: 101%;
    width: 101%;
}
  }

  #blockAuth .progressAuth{
    width: 291px;
  }
  .topPanelLastonline {
    display: inline-block;
    position: absolute;
    float: left;
    left: 98px;
    top: 10px;
    font-size: 13px;
}
#noDialogsText{
  left: 15%;
}
  .mobileBackButton{
    display: block;
  }
   #blockAuth{
    width: 100%;
    margin: -110px 0 0 -0px;
    left: 0px;
  }
}


</style>
</head> 
<body> 

<div class="callingProcessBlock scale-transition scale-out popUpDialog z-depth-5">
<div class="cirleLoadUserImageCall"></div>
  <img src="" id="userImageCalling">
  <p class="callingTime scale-transition scale-out simpleInformation">00:12</p>
   <center>

   <section id="meCallToFriend">
   <p class="userInfoCall" class="truncate">Hello Man!</p>
   <div class="animationCalling">
 <div class="animationSpan"></div>
 <div class="animationSpan"></div>
 <div class="animationSpan"></div>
  </div>
     <a class="btn-floating btn-large waves-effect waves-light red scale-transition scale-out" id="callingEnd" onclick="

     "><i class="material-icons">phone</i></a>
     </section>

      <section id="friendCallToMe" style="display: none;">
   <p class="userInfoCall" class="truncate">Hello Man!</p>

     <a class="btn-floating btn-large waves-effect waves-light red scale-transition scale-out" id="callingDisline"><i class="material-icons">phone</i></a>
     <a class="btn-floating btn-large waves-effect waves-light green scale-transition scale-out" id="callingAccept"><i class="material-icons">phone</i></a>
     </section>

   </center>
</div>
<div class="z-depth-3 popUpDialog dragAndDrop">

  <center><p id="dragText">Перетащите файл сюда</p></center>

</div>

<div class="photoWatcher" onclick="$(this).fadeOut(100); $('#closePhoto').css('transform', 'rotate(-41deg)');">
<div class="progress" style="
    position: absolute;
    bottom: 25%;
    width: 75%;
    display: none;
    left: 15%;
">
      <div class="indeterminate"></div>
  </div>
  <i class="material-icons closeIcon" id="closePhoto" onclick="$(this).parent().fadeOut(100); $(this).css('transform', 'rotate(-41deg)');">close</i>
<img src="" class="imageView">
</div>


<div class="popUpDialog mySettings">



  <div id="headerBlock">
   <p id="loginUser" style="" class='truncate'>@DuckerMan</p>
   <div class="cirleLoadImage"></div>
    <img src="" id="myProfilePhoto" style="cursor: pointer;" onclick="$('.photoWatcher').fadeIn(200);
$('.photoWatcher .closeIcon').css('transform', 'rotate(0deg)'); $('.photoWatcher .imageView').attr('src', $(this).attr('src'));">
    <p id="nameAndSurname" style="" class='truncate'>Sergey the Duck</p>
 <a class="btn-floating btn-large waves-effect waves-light waves-effect waves-circle scale-transition scale-out" id="buttonChangeProfilePhoto" onclick="console.log('trugger'); $('.uploadImageInput').trigger('click');"><i class="material-icons">add_a_photo</i></a>
  </div>

</div>


<div class="popUpDialog myСontacts z-depth-3">


<div class="preloader-wrapper active" id="prealoderContacts" style="z-index: 1; width: 48px;height: 48px;position: absolute;left: 42%;top: 41%;/* display: none; */">
    <div class="spinner-layer spinner-red-only">
      <div class="circle-clipper left">
        <div class="circle"></div>
      </div><div class="gap-patch">
        <div class="circle"></div>
      </div><div class="circle-clipper right">
        <div class="circle"></div>
      </div>
    </div>
  </div>









  <div id="headerTitle">
   <i class="waves-effect waves-circle material-icons mobileBackButton" id="backContacts" onclick="$('.myСontacts').fadeOut(150); $('#mask').fadeOut(25);">arrow_back</i>
  <i class="material-icons closeIcon" id="closeContacts" onclick="$('.myСontacts').fadeOut(150); $('#mask').fadeOut(25);">close</i>
  <p id="titleHeaderText">Контакты</p>
  </div>

  <div class="contentContacts">



    
  </div>
<a class="btn-floating btn-large waves-effect waves-light red" style="    right: 10px;
    position: absolute;
    bottom: 10px;" onclick="
$('.addContact').fadeIn(25); $('#mask').css('z-index', '16');" ><i class="material-icons">add</i></a>
</div>

<div class="popUpDialog addContact z-depth-3">
<center>

          
          <div class="input-field inline" style="    width: 184px;
    position: relative;
    top: 7px;
}">
            <input id="emailContacts" type="email" class="validate">
            <label for="emailContacts" data-error="неверно" data-success="">Email</label>
          </div>

           <div class="input-field inline" style="    width: 184px;
    position: relative;
    top: -5px;
}">
            <input id="nameContacts" type="text">
            <label for="nameContacts">Имя</label>
          </div>



<div class="divider" style="
    position: relative;
    top: -8px;
"></div>

 <a class="btn-flat waves-effect waves-teal" style="
    float: left;
    position: absolute;
    left: 0px;
    bottom: -2px;
    color: #2525ff;
" onclick="$('.addContact').fadeOut(25); $('#mask').css('z-index', '')">ОТМЕНА</a>
 <a class="btn-flat waves-effect waves-teal" style="
    float: right;
    position: absolute;
    bottom: -2px;
    color: #2525ff;
" onclick="client.onContactsAdding($('#emailContacts').val(), $('#nameContacts').val());">ДОБАВИТЬ</a>


          </center>
        </div>



<div class="popUpDialog fileUploadingInfo"><img src="" class="filePreview" style="
  ">
  <p class="fileName truncate">Алексей Кривов.png</p>
  <p class="bytesLoading"><span id="loading">1.2мб</span> / <span id="total">10мб</span></p>

  <div class="progress loadProgress">
      <div class="determinate" style="width: 0%;background: #a5a5a5;"></div>
  </div>
  </div>




<ul id="slide-out" class="side-nav">
    <li><div class="user-view">
      <div class="background">
        <img src="images/background.jpg">
      </div>


      <a href="#!info"><img onclick="$('.photoWatcher').fadeIn(200);
$('.photoWatcher .closeIcon').css('transform', 'rotate(0deg)'); $('.photoWatcher .imageView').attr('src', $(this).attr('src'));" class="circle" id="infoPanelImage" src="images/defaultprofileimage.jpg"></a>
      <a href="#!info"><span class="white-text name" id="infoPanelName" class="truncate">Орехус</span></a>
      <a href="#!info"><span class="white-text email" id="infoPanelLogin" class="truncate">орехус@gmail.com</span></a>
    </div></li>
    
    <li class="waves-effect" style="width: 100%;" onclick="$('#mask').show(50);
$('.mySettings').show(25);

 $('#buttonChangeProfilePhoto').removeClass('scale-out');
  $('#buttonChangeProfilePhoto').removeClass('scale-in');
 $('#buttonChangeProfilePhoto').addClass('scale-in');


$('#nameAndSurname').text($('#infoPanelName').text());

$('#loginUser').text($('#infoPanelLogin').text());

$('#myProfilePhoto').attr('src', $('#infoPanelImage').attr('src'));
"><a style="cursor: pointer;"><i class="material-icons">settings</i><span style="margin-left: -17px;">Настройки</span></a></li>
    <li class="waves-effect" style="width: 100%;" onclick="$('#mask').show(50);
$('.myСontacts').show(100);


client.onClickContacts();



"><a style="cursor: pointer;"><i class="material-icons">contacts</i><span style="margin-left: -17px;">Контакты</span></a></li>

    <li class="waves-effect" style="width: 100%;"><a style="cursor: pointer;"><i class="material-icons">&#xE8AF;</i><span style="margin-left: -17px;">Поддержка</span></a></li>
  
  </ul>
  






 <!-- Modal Structure -->
  <div id="modal1" class="modal">
    <div class="modal-content">
      <h4 id="textModalHeader">Modal Header</h4>
      <p id="textModal">A bunch of text</p>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">ОК</a>
    </div>
  </div>
          



<div id="mask"></div>
<div id="firstLoadingAnimation"></div>
<div class="popUpDialogInfo" id="infoPopup" style="z-index: 17;">
  
  <p id="title">Are you love Duck?</p>
  <br>
  <p id="text">I love Ducks, do you?</p>

  <a class="waves-effect waves-red btn-flat" id="cancelButton" onclick="$('#mask').hide();">CANCEL</a>
   <a class="waves-effect waves-green btn-flat" id="agreeButton" onclick="  $('#mask').hide();">OK</a>
</div>


<div class="simpleBlock" style="display: none;z-index: 4;" id="blockAuth">
  


<center>

<section id="firstAuthSection">
  
<p id="title">Пожалуйста, введите ваш логин</p>
<div class="input-field col" style="    width: 275px;top: 16px;">
          <input id="myLoginInput" type="text" class="validate">
          <label for="myLoginInput" id="myLoginInputLabel">Логин</label>
        </div>


<a class="waves-effect waves-light btn nextStepButton" id="nextStepButtonAuth" onclick="client.authAccount($('#myLoginInput').val());">Далее</a>
<p class="subText" id="subText">Проверка..</p>
<div class="progress progressAuth" id="progressAuth">
      <div class="indeterminate"></div>
  </div>

</section>



<section id="needAuthcodeSection" style="display: none;">
  
<p id="title">Пожалуйста, введите код авторизации</p>
<div class="input-field col" style="    width: 275px;top: 16px;">
          <input id="myAuthcodeInput" type="text" class="validate">
          <label for="myAuthcodeInput" id="myAuthcodeInputLabel">Код авторизации</label>
        </div>


<a class="waves-effect waves-light btn nextStepButton" id="nextStepButtonAuthcode" onclick="client.enterCode($('#myLoginInput').val(), $('#myAuthcodeInput').val());">Далее</a>
<p class="subText" id="subText">Проверка..</p>
<div class="progress progressAuth" id="progressAuthCode">
      <div class="indeterminate"></div>
  </div>
  
</section>


<section id="needRegcodeSection" style="display: none;">
  
<p id="title">Пожалуйста, введите код регистрации</p>
<div class="input-field col" style="    width: 275px;top: 16px;">
          <input id="myRegcodeInput" type="text" class="validate">
          <label for="myRegcodeInput">Код регистрации</label>
        </div>


<a class="waves-effect waves-light btn nextStepButton" id="nextStepButtonRegcode" onclick="client.validateAccount($('#myLoginRegInput').val(), $('#myRegcodeInput').val());">Далее</a>
<p class="subText" id="subText">Проверка..</p>
<div class="progress progressAuth" id="progressAuthCode">
      <div class="indeterminate"></div>
  </div>
  
</section>


<section id="registrationS" style="display: none;">
  
<p id="title">Пожалуйста, введите ваши данные</p>



<div class="input-field col inline" style="   width: 225px;top: -21px;float: left;">
          <i class="material-icons prefix" style="    color: #c73636;">account_circle</i>
          <input id="myNameInput" type="text" class="validate">
          <label for="myNameInput">Имя</label>
        </div>

<div class="input-field col inline" style="    width: 225px;top: -21px;float: left;">
          <i class="material-icons prefix" style="    color: #c73636;">account_circle</i>
          <input id="mySurnameInput" type="text" class="validate">
          <label for="mySurnameInput">Фамилия</label>
        </div>


        <div class="input-field col inline" style="   width: 225px;top: -21px;float: left;">
          <i class="material-icons prefix" style="    color: #c73636;">email</i>
          <input id="myEmailInput" type="text" class="validate">
          <label for="myEmailInput">Почта</label>
        </div>

<div class="input-field col inline" style="    width: 225px;top: -21px;float: left;">
          <i class="material-icons prefix" style="    color: #c73636;">account_box</i>
          <input id="myLoginRegInput" type="text" class="validate">
          <label for="myLoginRegInput">Логин</label>
        </div>

<a class="waves-effect waves-light btn nextStepButton" id="nextStepButtonRegister" onclick="client.registration($('#myEmailInput').val(), $('#myLoginRegInput').val(), $('#myNameInput').val(), $('#mySurnameInput').val());" style="top: -31px;">Далее</a>
<p class="subText" id="subText">Проверка..</p>
<div class="progress progressAuth" id="progressAuthCode" style="top: -29px;">
      <div class="indeterminate"></div>
  </div>
  
</section>

</center>

</div>

 <div class="row" style="display: none;background: #e7ebf0;">
 
<div id="leftPanelMessages" class="z-depth-1">
  <div id="topPanelWithMenu">
    <a href="#" data-activates="slide-out" class="button-collapse"><i class="material-icons" style="    font-size: 46px;
    color: #757575;
    top: -1px;
    position: relative;
}">menu</i></a>

<div class="searchBlockTopPanel" style=""><input type="text" placeholder="Поиск" name="search" class="searchInputTopPanel browser-default ">


</div>

  </div>

<p id="noDialogsText"></p>


<div class="preloader-wrapper active" id="prealoderDialogs" style="
    width: 48px;
    height: 48px;
    position: absolute;
    left: 42%;
    top: 41%;
">
    <div class="spinner-layer spinner-red-only">
      <div class="circle-clipper left">
        <div class="circle"></div>
      </div><div class="gap-patch">
        <div class="circle"></div>
      </div><div class="circle-clipper right">
        <div class="circle"></div>
      </div>
    </div>
  </div>



<!-- <div class="dialog" id="messageGolyb">
  <p id="userName">Тимур Ганиуллин</p>
   <p id="textMessage" style="
">го в майн</p>
  <img src="https://pp.userapi.com/c840638/v840638859/f4b7/IPoJGS6Zfyo.jpg" id="profilePhoto"></img>
</div> -->

</div>





<div class="rightBlock">

<div class="preloader-wrapper big active " id="spinnerMessages" style="
    width: 48px;
    height: 48px;
    position: absolute;
    z-index: 100;
    left: 42%;
    top: 43%;
    display: none;
    -webkit-animation: container-rotate 1010ms linear infinite;
    animation: container-rotate 1010ms linear infinite;
">
    <div class="spinner-layer spinner-red-only">
      <div class="circle-clipper left">
        <div class="circle"></div>
      </div><div class="gap-patch">
        <div class="circle"></div>
      </div><div class="circle-clipper right">
        <div class="circle"></div>
      </div>
    </div>
  </div>



<!-- <div class="messagesBlock" id="blockTester">
  
  <div id="userInfoTopPanel" class="z-depth-2">
    <img src="" id="profilePhotoTopPanel">
  <p id="topPanelName">Тимур Ганиуллин</p>
  <p id="topPanelLastonline">Онлайн</p>
  </div>


</div> -->

</div>

</div>

  <a class="btn-floating btn-large red scale-transition scale-out callReturnButton"><i class="material-icons">phone</i></a>


<form style="opacity: 0;position: absolute;left: -1000%;" id="formInputFile">
  
  <input type="file" name="file" class="uploadFileInput" multiple style="
">


  <input type="file" name="file" onchange=" 


   if($('.uploadImageInput').get(0).files.length === 0) return false;
    var files = this.files;

    client.onLoadProfilePhoto(files);

    $('.uploadImageInput').val(null); " class="uploadImageInput" style="
">
  <input type="submit" value="" class="buttonLoadFile" style="
">

</form>


<script>

 $(document).ready(function(){
    // the "href" attribute of the modal trigger must specify the modal ID that wants to be triggered
    $('.modal').modal();
  });
      

function init(){
  var system = getMobileOperatingSystem();

  if(system=='iOS') {
    $('#titleHeaderText').css('left', '35%');
  }
}

$('.cirleLoadImage').circleProgress({
    value: 0.0,
    size: 40,
    emptyFill: "rgba(0, 0, 0, 0)",
    fill: {
      color: "#bbbbbb"
    }
  });



$('.uploadFileInput').on('change', function(e){
 


 if($('.uploadFileInput').get(0).files.length === 0) return false;



    var files = this.files;

    client.onLoadAttachment(files);

    $('.uploadFileInput').val(null); 
});


$('.searchInputTopPanel').on('input', function(){
  var val = $(this).val();

if(!isEmpty(val) || val != ""){
// search

$('.dialog[data-issearch!="true"]').animate({left:'-100%'}, 50);
$('.dialog[data-issearch!="true"]').hide();
client.onUserSearch(val);

}
else{

$('.dialog[data-issearch!="true"]').animate({left:'0px'}, 50);
$('.dialog[data-issearch!="true"]').show();
$('.dialog[data-issearch="true"]').remove();
}
});

function forEach(data, callback){
  for(var key in data){
    if(data.hasOwnProperty(key)){
      callback(key, data[key]);
    }
  }
}


$('.cirleLoadUserImageCall').circleProgress({
    value: 0.0,
    size: 60,
    emptyFill: "rgba(0, 0, 0, 0)",
    fill: {
      color: "#b7b7b7"
    }
  });


 $('.button-collapse').sideNav({
      menuWidth: 320, // Default is 300
      edge: 'left', // Choose the horizontal origin
      closeOnClick: true, // Closes side-nav on <a> clicks, useful for Angular/Meteor
      draggable: true, // Choose whether you can drag to open on touch screens,
      onOpen: function(el) { /* Do Stuff */ }, // A function to be called when sideNav is opened
      onClose: function(el) { /* Do Stuff  */ }, // A function to be called when sideNav is closed
    }
  );
var tmpSocket = new ServerCommunitation(io());
tmpSocket.socketCopy.on('connect', function(){




 
})
var client = new Client(tmpSocket);


tmpSocket = undefined;







 if(getCookie('lastLogin') != undefined && getCookie('lastCrt')!=undefined){
  client.authByCrt(getCookie('lastLogin'), getCookie('lastCrt'));
}



  client.onResize();




$(window).resize(function(e){
client.onResize();

});



$(window).on('load', function(){
  if(getCookie('firstLogin')==undefined){



$('#firstLoadingAnimation').show();
}

});



$('html')[0].ondragover = function() {

if(isEmpty($('.selectedDialog').attr('id'))) return false;


    $('.dragAndDrop').show();
$('#mask').show();
    return false;
};
$('html')[0].ondragleave = function() {

 
    return false;
};


$('.dragAndDrop')[0].ondrop = function(event) {
    event.preventDefault();
    console.log('drop');

    client.onLoadAttachment(event.dataTransfer.files);
    $('.dragAndDrop').hide();



};



$(document).ready(function(){


  if(getCookie('firstLogin')==undefined){
    setCookie('firstLogin', true);

    $('#firstLoadingAnimation').css('animation', 'null');
  $('#firstLoadingAnimation').animate({top:'-1000px', left:'-1000px', height:'5500px', width:'5500px'}, 250, function(){
    $('#firstLoadingAnimation').fadeOut(250);

    setTimeout(function(){
      $('#blockAuth').show();
    }, 300);
  });

  }

  else{

    $('#blockAuth').show();
  }
 
  
})



$(window).on('keyup', function(e){
  if(e.keyCode==27){
    $('.photoWatcher').fadeOut(100); $('#closePhoto').css('transform', 'rotate(-41deg)');
  }
if(e.keyCode==13){
  if($('.selectedDialog').attr('id')==undefined) return false;


  var to = $('.selectedDialog').attr('id').replace('message', '');


  client.sendMessage($('#block'+to+' .messageSendBlock').text(), to);
  setTimeout(function(){
    $('#block'+to+' .messageSendBlock').html('');
  }, 250);
  
} 
});





function modulesWindow(){


  this.closeWindows = function(){
    $('#mask').hide();
    $('.popUpDialog').hide();
    $('.popUpDialogInfo').hide();
  };
  this.openWindow = function(win, data){
    // data = {onAgree:function(){}, onCancel:function(){}}
    $('#mask').show(50);
    $('#'+win).show(25);

  };

  this.closeMobileWindow=function(windowClose, windowOpen){

    windowOpen.show();
    windowOpen.css('left', '0px');
    console.log(windowClose);
    console.log(windowOpen);
    windowClose.animate({left:'-105%'}, 200);
  
    windowClose.fadeOut(50);

  };



   this.openWindowText = function(win, data){
     // data = {onAgree:function(){}, onCancel:function(){}, text:'Duck', title:'Quack'}
    $('#mask').show();
     $('#modal1').modal('open');
     $('#textModalHeader').text(data['title']);
     $('#textModal').text(data['text']);


  };
}


/*if(getCookie('lastLogin') != undefined && getCookie('lastCrt')!=undefined){
  client.authByCrt(getCookie('lastLogin'), getCookie('lastCrt'));
}*/
function getCookie(name) {
  var matches = document.cookie.match(new RegExp(
    "(?:^|; )" + name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g, '\\$1') + "=([^;]*)"
  ));
  return matches ? decodeURIComponent(matches[1]) : undefined;
}



function setCookie(name, value, options) {
  options = options || {};

  var expires = options.expires;

  if (typeof expires == "number" && expires) {
    var d = new Date();
    d.setTime(d.getTime() + expires * 1000);
    expires = options.expires = d;
  }
  if (expires && expires.toUTCString) {
    options.expires = expires.toUTCString();
  }

  value = encodeURIComponent(value);

  var updatedCookie = name + "=" + value;

  for (var propName in options) {
    updatedCookie += "; " + propName;
    var propValue = options[propName];
    if (propValue !== true) {
      updatedCookie += "=" + propValue;
    }
  }

  document.cookie = updatedCookie;
}

function strstr( haystack, needle, bool ) { // Find first occurrence of a string
  // 
  // +   original by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)

  var pos = 0;

  pos = haystack.indexOf( needle );
  if( pos == -1 ){
    return false;
  } else{
    if( bool ){
      return haystack.substr( 0, pos );
    } else{
      return haystack.slice( pos );
    }
  }
}

function AudioOnNewMessage() {
  var audio = new Audio(); 
  audio.src = 'audio/newMessage.mp3'; 
  audio.autoplay = true; 
}



   

     


function escapeHtml(text) {
  var map = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#039;'
  };

  return text.replace(/[&<>"']/g, function(m) { return map[m]; });
}
function replaceURLWithHTMLLinks(text) {
    var exp = /(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
    return text.replace(exp,"<a class='messageLinkText' target='_blank' href='$1'>$1</a>"); 
}

function addslashes(str) {
  if(typeof str == 'number') return str;
    str=str.replace(/\\/g,'\\\\');
    str=str.replace(/\'/g,'\\\'');
    str=str.replace(/\"/g,'\\"');
    str=str.replace(/\0/g,'\\0');
    return str;
}


/*
$('.messageSendBlock').on('focus', function(){
console.log('Focus on msg block');
$('.messageSendBlock').height('75px');
$('.messageSendBlock').css('border-bottom', '2px solid #dedede;');
});
$('.messageSendBlock').on('blur', function(){
console.log('blur on msg block');
$('.messageSendBlock').height('47px');
$('.messageSendBlock').css('border-bottom', '1px solid #dedede;');
});*/

$(document).on('input', '#myAuthcodeInput', function () {
  console.log('INPUT');
  var $item = $(this),
    value = $item.val();

    if(value.length == 4){
     client.enterCode($('#myLoginInput').val(), value);
    }
    if(value.length > 4){
      $item.val(value.substr(0, 4));
    }

});

$(document).on('input', '#myRegcodeInput', function () {
  var $item = $(this),
    value = $item.val();
console.log('INPUT');
    if(value.length == 4){
     client.validateAccount($('#myLoginRegInput').val(), value);
    }
    if(value.length > 4){
      $item.val(value.substr(0, 4));
    }

});

function isEmpty(obj) {

    // null and undefined are "empty"
    if (obj == null) return true;

    // Assume if it has a length property with a non-zero value
    // that that property is correct.
    if (obj.length > 0)    return false;
    if (obj.length === 0)  return true;

    // If it isn't an object at this point
    // it is empty, but it can't be anything *but* empty
    // Is it empty?  Depends on your application.
    if (typeof obj !== "object") return true;

    // Otherwise, does it have any properties of its own?
    // Note that this doesn't handle
    // toString and valueOf enumeration bugs in IE < 9
    for (var key in obj) {
        if (hasOwnProperty.call(obj, key)) return false;
    }

    return true;
}

setInterval(function(){
  if(!document.hidden) $('title').html('Duck Messenger');
  
}, 777);



function getMobileOperatingSystem() {
  var userAgent = navigator.userAgent || navigator.vendor || window.opera;

      // Windows Phone must come first because its UA also contains "Android"
    if (/windows phone/i.test(userAgent)) {
        return "Windows Phone";
    }

    if (/android/i.test(userAgent)) {
        return "Android";
    }

    // iOS detection from: http://stackoverflow.com/a/9039885/177710
    if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
        return "iOS";
    }

    return "unknown";
}


</script>
</body> 
</html>