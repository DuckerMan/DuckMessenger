<!DOCTYPE html> 


<html> 
<head> 






  <script src="//ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <script language="javascript" src="js/lz-string.js"></script>
   <script language="javascript" src="js/async.js"></script>
<!--  <script src="/js/recorder.js"></script> -->
<script type="text/javascript" src="https://cdn.rawgit.com/ricmoo/aes-js/e27b99df/index.js"></script>
 <!-- Compiled and minified CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">

  <!-- Compiled and minified JavaScript -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>
<!--   <script src="assets/js/main.js"></script> -->

  <script src="/socket.io/socket.io.js"></script>
  

  
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
   
        <meta name="viewport" content="initial-scale=1, maximum-scale=1">
<title>DuckMessenger</title> 
 <meta name="description" content="DuckMessenger is a free and opensource Messenger">


<style>

html{overflow: hidden;background: #5682a3;font-family: Roboto;}
@import url('https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300|Open+Sans:100,200,300,400,500,600,700|Poiret+One|Roboto:100,200,300, 300i,400, 400i,500, 500i,700&subset=cyrillic');

 @font-face {
    font-family: ProximaNovaCondesedSemibold; /* Имя шрифта */
    src: url(Proxima Nova Condensed Semibold.otf); /* Путь к файлу со шрифтом */
   }
    @font-face {
    font-family: ProximaNovaRegular; /* Имя шрифта */
    src: url(Proxima Nova Regular.otf); /* Путь к файлу со шрифтом */
   }
    @font-face {
    font-family: ProximaNovaSemibold; /* Имя шрифта */
    src: url(Proxima Nova Semibold.otf); /* Путь к файлу со шрифтом */
   }


.PopUpDialog{
  width: 480px;
height: 290px;
position: absolute;
background:white;
border-radius: 2px;
    z-index: 10000005000000;

position:absolute;
left:50%;
top:50%;
margin:-120px 0 0 -240px;
overflow: hidden;
}


</style>
</head> 
<body> 





 <div class="row" style="display: none;background: #e7ebf0;">
 


</div>

<script>



var socket = new ServerCommunitation(io());








function ServerCommunitation(socketObj){





  var socket = socketObj;


  this.sendRequest = function(params){
    return new Promise(function(resolve, reject){
      socket.emit('request', LZString.compress(JSON.stringify(params)), function(data){
        resolve(data);
      });
    });
    
  };


}




function getCookie(name) {
  var matches = document.cookie.match(new RegExp(
    "(?:^|; )" + name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g, '\\$1') + "=([^;]*)"
  ));
  return matches ? decodeURIComponent(matches[1]) : undefined;
}

function setCookie(name, value, options) {
  options = options || {};

  var expires = options.expires;

  if (typeof expires == "number" && expires) {
    var d = new Date();
    d.setTime(d.getTime() + expires * 1000);
    expires = options.expires = d;
  }
  if (expires && expires.toUTCString) {
    options.expires = expires.toUTCString();
  }

  value = encodeURIComponent(value);

  var updatedCookie = name + "=" + value;

  for (var propName in options) {
    updatedCookie += "; " + propName;
    var propValue = options[propName];
    if (propValue !== true) {
      updatedCookie += "=" + propValue;
    }
  }

  document.cookie = updatedCookie;
}

function strstr( haystack, needle, bool ) { // Find first occurrence of a string
  // 
  // +   original by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)

  var pos = 0;

  pos = haystack.indexOf( needle );
  if( pos == -1 ){
    return false;
  } else{
    if( bool ){
      return haystack.substr( 0, pos );
    } else{
      return haystack.slice( pos );
    }
  }
}

function AudioOnNewMessage() {
  var audio = new Audio(); // Создаём новый элемент Audio
  audio.src = 'audio/newMessage.mp3'; // Указываем путь к звуку "клика"
  audio.autoplay = true; // Автоматически запускаем
}



   function GeneratePublicKey256(){
            var key = Array();

            for(var i = 0;i < 33;i++){
              if(key.length == 32){
                 return toHexString(key);
              
              }


            key.push(Math.floor(Math.random() * 256));
            }
            

             }

       function toHexString(byteArray) {
  return Array.from(byteArray, function(byte) {
    return ('0' + (byte & 0xFF).toString(16)).slice(-2);
  }).join('')
}


function escapeHtml(text) {
  var map = {
    '&': '&amp;',
    '<': '&lt;',
    '>': '&gt;',
    '"': '&quot;',
    "'": '&#039;'
  };

  return text.replace(/[&<>"']/g, function(m) { return map[m]; });
}
function replaceURLWithHTMLLinks(text) {
    var exp = /(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
    return text.replace(exp,"<a class='MessageLinkHref' onclick='IsHavePreview($1)'>$1</a>"); 
}

function addslashes(str) {
  if(typeof str == 'number') return str;
    str=str.replace(/\\/g,'\\\\');
    str=str.replace(/\'/g,'\\\'');
    str=str.replace(/\"/g,'\\"');
    str=str.replace(/\0/g,'\\0');
    return str;
}




setInterval(function(){
  if(!document.hidden) $('title').html('Duck Messenger');
  
}, 777)
</script>
</body> 
</html>